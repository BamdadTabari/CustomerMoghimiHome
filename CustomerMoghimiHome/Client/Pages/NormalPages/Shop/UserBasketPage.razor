@page "/basket"

<PageTitle>Basket</PageTitle>
<AuthorizeView>
    <Authorized>
        <MudAlert Class="border border-5" Severity="Severity.Info" ContentAlignment="HorizontalAlignment.Center">
            <MudStack>
                <MudText Typo="Typo.h6" Align="Align.Center">
                    ابتدا سبد خرید خود را بررسی کنید
                    سپس بر روی گزینه ثبت سفارش کلیک نمایید.
                </MudText>
                <MudButton Variant="Variant.Filled" Color="Color.Success" OnClick="SubmitOrder">
                    ثبت سفارش
                </MudButton>
            </MudStack>
        </MudAlert>
        @if (model != null)
        {
            <MudGrid Justify="Justify.Center" Class="bg-color-melo">
                @foreach (var item in model)
                {
                    <MudItem lg="6" xl="6" class="d-flex justify-center" md="6" sm="12" xs="12" Style="display:flex;">
                        <MudCard>
                            <MudCardContent>
                                <MudStack>
                                    <MudImage Alt="@item.ImageAlt" Src="@item.ImagePath" ObjectFit="ObjectFit.ScaleDown" Class="align-center" />
                                    <hr />
                                    <MudText Typo="Typo.h5" Align="Align.Center">@item.ProductName</MudText>
                                </MudStack>
                                <br />
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                    <MudItem class="d-flex justify-center" lg="6" xl="6" md="6" sm="12" xs="12" Style="display:flex;">
                        <MudCard>
                            <MudCardContent>
                                <br />
                                <MudText Typo="Typo.h6" Align="Align.End">_شرکت سازنده_</MudText>
                                <MudText Typo="Typo.h6">@item.BuilderCompany</MudText>
                                <hr />
                                <MudText Typo="Typo.h6" Align="Align.End">ـ قیمت ـ</MudText>
                                <MudText Typo="Typo.h6">@item.Price</MudText>
                                <hr />
                                <MudText Typo="Typo.h6" Align="Align.End">ـ تعداد ـ</MudText>
                                <MudText Typo="Typo.h6">@item.Quantity</MudText>
                            </MudCardContent>
                            <MudCardActions>
                                <MudButton OnClick="()=> ChangeProductQuantity(item.ProductName, item.Id, item.Quantity)"
                                   Color="Color.Primary" Variant="Variant.Filled" EndIcon="@Icons.Material.Filled.Edit">
                                    <MudText Align="Align.Center" Typo="Typo.h6">
                                        تغییر تعداد
                                    </MudText>
                                </MudButton>
                            </MudCardActions>
                        </MudCard>
                    </MudItem>
                }
            </MudGrid>
        }
        else
        {
            <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
            <MudProgressLinear Color="Color.Secondary" Indeterminate="true" Class="my-7" />
        }
    </Authorized>
    <NotAuthorized>
        <HasNoUserAccess />
    </NotAuthorized>
</AuthorizeView>